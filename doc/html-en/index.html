<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pool Games: Contracts for periodic reward draws on deposit pools in farms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pool Games
   </div>
   <div id="projectbrief">Pool Games by Tezos smart contract soft configurable</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Contracts for periodic reward draws on deposit pools in farms </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_d_dd_tezos_tzpool_README"></a> <a href="https://github.com/dimdim1177/tezos-pool-games">https://github.com/dimdim1177/tezos-pool-games</a> Full code and documentation of contracts for periodic reward draws on deposit from pools in farms Crunchy or Qupipuswap. Project developed on Debian 11, not tested in other OS.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Getting start</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Install tools</h2>
<p>Execute script <code>./install/install_all.sh</code> for download and install: LIGO, tezos-client, python, pytezos and so on. Or execute ./install/install_*.sh scripts for each tool manually.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Compile</h2>
<p>Usage: compile.sh NAME|ALL Compile 'contracts/NAME.ligo' or 'contracts/*.ligo' for ALL. Compiled files saved to 'build/NAME.tz' and 'build/NAME.storage.tz' files.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Tests</h2>
<p>Usage: tests.sh NAME|ALL Execute tests 'tests/NAME.ligo' or 'tests/*.ligo' for ALL. Logs saved to 'build/NAME.test.log' files.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Deploy</h2>
<p>Usage: deploy.sh NAME|ALL [force] Deploing 'build/NAME.tz' inited by 'build/NAME.storage.tz' (or 'build/*.tz' for ALL) by account saved as 'owner' in tezos-client.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Documentation</h2>
<p>Firstly, install submodules by <code>git submodule update --init --recursive</code>. Then execute script <code>./doc/doc.sh</code> for generate English and Russian documentations for contracts. Script usage code of subprojects, attached as git submodule:</p><ul>
<li><a href="https://github.com/dimdim1177/mlcomment">https://github.com/dimdim1177/mlcomment</a> Multi-Language comments</li>
<li><a href="https://github.com/dimdim1177/ligo2dox">https://github.com/dimdim1177/ligo2dox</a> Convert PascaLIGO to C++ like code for auto-documenting by Doxygen</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Contracts</h1>
<h2><a class="anchor" id="autotoc_md8"></a>
Contract with pools</h2>
<p>See <a class="el" href="CPoolGames_8ligo.html">contracts/CPoolGames.ligo</a> and folder contracts/CPoolGames. Main features:</p><ul>
<li>Support 2 farms interfaces: Crunchy and QUIPU</li>
<li>Three algorithms to determine the winner:<ul>
<li>Probability of win proportional time in current game</li>
<li>Probability of win proportional sum of time * deposit in current game</li>
<li>Equal probabilities for all users in pool</li>
</ul>
</li>
<li>Additional pool options:<ul>
<li>minimal deposit</li>
<li>minimal seconds in game</li>
<li>maximum deposit (only for algorithm by sum time * deposit)</li>
<li>win percent, burn percent, fee percent</li>
<li>burn token, fee address</li>
</ul>
</li>
<li>Flexible code configuration (see <a class="el" href="CPoolGames_2config_8ligo.html" title="Configuration of contract (compilation options)">contracts/CPoolGames/config.ligo</a>):<ul>
<li>pool owner/admins or pool as service</li>
<li>can enable security transfer tokens (remove operator after transfer)</li>
<li>can enable pool statictics in blockchain for promotion</li>
<li>can enable pool views for other smart contracts</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md9"></a>
Contract for generate random numbers</h2>
<p>See <a class="el" href="CRandom_8ligo.html">contracts/CRandom.ligo</a> and folder contracts/CRandom Main features:</p><ul>
<li>Any can request random number in future</li>
<li>Request has caller address and ID of object</li>
<li>Random number based on nearest Tezos block hash with time more time in request and XORed with hash of request, that is why one Tezos block generate different random numbers for different requests with the same time.</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
Lexem prefixes</h2>
<ul>
<li><b>C</b> - Contract</li>
<li><b>M</b> - Module</li>
<li><b>t_</b> - Type</li>
<li><b>c_</b> - Constant</li>
<li><b>cERR_</b> - Constant with error code for failwith</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
Folders tree</h1>
<h2><a class="anchor" id="autotoc_md12"></a>
contracts</h2>
<p>Folder with contracts code. Files by mask contracts/CONTRACT_NAME.ligo compiled as contracts. Folder contracts/CONTRACT_NAME used for contract specific includes and modules. File contracts/CONTRACT_NAME/config.ligo contains contract configuration defines. File contracts/CONTRACT_NAME/initial_storage.ligo contains initial storage description.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
contracts/include</h3>
<p>Common includes for all contracts.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
contracts/module</h3>
<p>Common modules for all contracts.</p>
<h3><a class="anchor" id="autotoc_md15"></a>
contracts/CPoolGames</h3>
<p>Includes and modules specific for contract <a class="el" href="CPoolGames_8ligo.html">contracts/CPoolGames.ligo</a>.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
contracts/CRandom</h3>
<p>Includes and modules specific for contract <a class="el" href="CRandom_8ligo.html">contracts/CRandom.ligo</a>.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
doc</h2>
<p>Documentation folder. File algo.xlsx - example in comparing table of changeing weights users and game in different alrorithms in different situations for simplify understanding weight code logic.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
html-en</h3>
<p>English documentation, please open doc/html-en/index.html</p>
<h3><a class="anchor" id="autotoc_md19"></a>
html-ru</h3>
<p>Russian documentation, please open doc/html-ru/index.html</p>
<h3><a class="anchor" id="autotoc_md20"></a>
doc/mlcomment</h3>
<p><a href="https://github.com/dimdim1177/mlcomment">https://github.com/dimdim1177/mlcomment</a> Multi-Language comments</p>
<h3><a class="anchor" id="autotoc_md21"></a>
doc/ligo2dox</h3>
<p><a href="https://github.com/dimdim1177/ligo2dox">https://github.com/dimdim1177/ligo2dox</a> Convert PascaLIGO to C++ like code for auto-documenting by Doxygen</p>
<h2><a class="anchor" id="autotoc_md22"></a>
accounts</h2>
<p>Folder with *.json faucet files, downloaded from <a href="https://teztnets.xyz/">https://teztnets.xyz/</a>, basename of file used as account name in tezos-client. One of it must be named as owner.json, this account used for deploy contracts. Script <code>accounts/activate.sh</code> activate all accounts in testnet.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
build</h2>
<p>Folder for compiled files *.tz, logs *.log and so on.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
install</h2>
<p>Folder with scripts for install development tools: LIGO, tezos-client and so on.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
tezbin</h2>
<p>Binaries from tezos: tezos-client and so on.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
tests</h2>
<p>Unit tests in LIGO. See tests <code>tests/CPoolGames.ligo</code> and <code>tests/CRandom.ligo</code>.</p>
<h3><a class="anchor" id="autotoc_md27"></a>
tests/include</h3>
<p>Common tests code</p>
<h3><a class="anchor" id="autotoc_md28"></a>
tests/CPoolGames</h3>
<p>Only <a class="el" href="classCPoolGames.html" title="Contract for periodic reward draws on deposit pools in farms.">CPoolGames</a> test code for include.</p>
<h3><a class="anchor" id="autotoc_md29"></a>
tests/CRandom</h3>
<p>Only <a class="el" href="classCRandom.html" title="Contract for SELDOM generation random number by request based on Tezos blocks.">CRandom</a> test code for include.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
venv</h2>
<p>Virtual envoriment for python </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
